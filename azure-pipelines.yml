trigger:
- none

name: Deploy App Registration Automation

variables:
  azureResourceManagerConnection: ICO-DEV-SERVICE-CONN
  displayName: IndigoMonitorApp-Automation
  refObjectId: 50a092f7-3eb3-4d89-b431-ebf8d1dbb447

pool:
  vmImage: 'windows-latest'
  
steps:
- task: PowerShell@2
  inputs:
    targetType: 'inline'
    script: |
      Install-Module -Name "AzureAD" -Scope CurrentUser -Force
    failOnStderr: true
    pwsh: true
- task: AzurePowerShell@5
  inputs:
    azureSubscription: $(azureResourceManagerConnection)
    ScriptType: 'FilePath'
    ScriptPath: './AppRegistration.ps1'
    ScriptArguments: 
      -displayName $(displayName)` 
      -refObjectId $(refObjectId)
    azurePowerShellVersion: 'LatestVersion'
    pwsh: true